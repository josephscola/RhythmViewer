
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Performance tips and tricks &#8212; My sample book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../../../" id="documentation_options" src="../../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../../_static/jquery.js"></script>
    <script src="../../../../../../_static/underscore.js"></script>
    <script src="../../../../../../_static/doctools.js"></script>
    <script src="../../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../../_static/copybutton.js"></script>
    <script src="../../../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">My sample book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../markdown-notebooks.html">
   Notebooks with MyST Markdown
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fenv/lib/python3.9/site-packages/mypyc/doc/performance_tips_and_tricks.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../../../../_sources/env/lib/python3.9/site-packages/mypyc/doc/performance_tips_and_tricks.rst"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#profiling">
   Profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#avoiding-slow-libraries">
   Avoiding slow libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#type-annotations">
   Type annotations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#avoiding-slow-python-features">
   Avoiding slow Python features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-fast-native-features">
   Using fast native features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adjusting-garbage-collection">
   Adjusting garbage collection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fast-interpreter-shutdown">
   Fast interpreter shutdown
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#work-smarter">
   Work smarter
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Performance tips and tricks</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#profiling">
   Profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#avoiding-slow-libraries">
   Avoiding slow libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#type-annotations">
   Type annotations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#avoiding-slow-python-features">
   Avoiding slow Python features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-fast-native-features">
   Using fast native features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adjusting-garbage-collection">
   Adjusting garbage collection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fast-interpreter-shutdown">
   Fast interpreter shutdown
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#work-smarter">
   Work smarter
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="performance-tips-and-tricks">
<span id="performance-tips"></span><h1>Performance tips and tricks<a class="headerlink" href="#performance-tips-and-tricks" title="Permalink to this headline">#</a></h1>
<p>Performance optimization is part art, part science. Just using mypyc
in a simple manner will likely make your code faster, but squeezing
the most performance out of your code requires the use of some
techniques we’ll summarize below.</p>
<section id="profiling">
<h2>Profiling<a class="headerlink" href="#profiling" title="Permalink to this headline">#</a></h2>
<p>If you are speeding up existing code, understanding where time is
spent is important. Mypyc speeds up code that you compile. If most of
the time is spent elsewhere, you may come back disappointed. For
example, if you spend 40% of time outside compiled code, even if
compiled code would go 100x faster, overall performance will only be
2.5x faster.</p>
<p>A simple (but often effective) approach is to record the time in
various points of program execution using <code class="docutils literal notranslate"><span class="pre">time.time()</span></code>, and to
print out elapsed time (or to write it to a log file).</p>
<p>The stdlib modules <code class="docutils literal notranslate"><span class="pre">profile</span></code> and <code class="docutils literal notranslate"><span class="pre">cProfile</span></code> can provide much more
detailed data. (But these only work well with non-compiled code.)</p>
</section>
<section id="avoiding-slow-libraries">
<h2>Avoiding slow libraries<a class="headerlink" href="#avoiding-slow-libraries" title="Permalink to this headline">#</a></h2>
<p>If profiling indicates that a lot of time is spent in the stdlib or
third-party libraries, you still have several options.</p>
<p>First, if most time is spent in a few library features, you can
perhaps easily reimplement them in type-annotated Python, or extract
the relevant code and annotate it. Now it may be easy to compile this
code to speed it up.</p>
<p>Second, you may be able to avoid the library altogether, or use an
alternative, more efficient library to achieve the same purpose.</p>
</section>
<section id="type-annotations">
<h2>Type annotations<a class="headerlink" href="#type-annotations" title="Permalink to this headline">#</a></h2>
<p>As discussed earlier, type annotations are key to major performance
gains. You should at least consider adding annotations to any
performance-critical functions and classes.  It may also be helpful to
annotate code called by this code, even if it’s not compiled, since
this may help mypy infer better types in the compile code. If you use
libraries, ensure they have stub files with decent type annotation
coverage. Writing a stub file is often easy, and you only need to
annotate features you use a lot.</p>
<p>If annotating external code or writing stubs feel too burdensome, a
simple workaround is to annotate variables explicitly. For example,
here we call <code class="docutils literal notranslate"><span class="pre">acme.get_items()</span></code>, but it has no type annotation. We
can use an explicit type annotation for the variable to which we
assign the result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">import</span> <span class="nn">acme</span>

<span class="k">def</span> <span class="nf">work</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Annotate &quot;items&quot; to help mypyc</span>
    <span class="n">items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">acme</span><span class="o">.</span><span class="n">get_items</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="o">...</span>  <span class="c1"># Do some work here</span>
</pre></div>
</div>
<p>Without the annotation on <code class="docutils literal notranslate"><span class="pre">items</span></code>, the type would be <code class="docutils literal notranslate"><span class="pre">Any</span></code> (since
<code class="docutils literal notranslate"><span class="pre">acme</span></code> has no type annotation), resulting in slower, generic
operations being used later in the function.</p>
</section>
<section id="avoiding-slow-python-features">
<h2>Avoiding slow Python features<a class="headerlink" href="#avoiding-slow-python-features" title="Permalink to this headline">#</a></h2>
<p>Mypyc can optimize some features more effectively than others. Here
the difference is sometimes big – some things only get marginally
faster at best, while others can get 10x faster, or more. Avoiding
these slow features in performance-critical parts of your code can
help a lot.</p>
<p>These are some of the most important things to avoid:</p>
<ul class="simple">
<li><p>Using class decorators or metaclasses in compiled code (that aren’t
properly supported by mypyc)</p></li>
<li><p>Heavy reliance on interpreted Python libraries (C extensions are
usually fine)</p></li>
</ul>
<p>These things also tend to be relatively slow:</p>
<ul class="simple">
<li><p>Using Python classes and instances of Python classes (native classes
are much faster)</p></li>
<li><p>Calling decorated functions (<code class="docutils literal notranslate"><span class="pre">&#64;property</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;staticmethod</span></code>, and
<code class="docutils literal notranslate"><span class="pre">&#64;classmethod</span></code> are special cased and thus fast)</p></li>
<li><p>Calling nested functions</p></li>
<li><p>Calling functions or methods defined in other compilation units</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">*args</span></code> or <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></p></li>
<li><p>Using generator functions</p></li>
<li><p>Using callable values (i.e. not leveraging early binding to call
functions or methods)</p></li>
</ul>
<p>Nested functions can often be replaced with module-level functions or
methods of native classes.</p>
<p>Callable values and nested functions can sometimes be replaced with an
instance of a native class with a single method only, such as
<code class="docutils literal notranslate"><span class="pre">call(...)</span></code>. You can derive the class from an ABC, if there are
multiple possible functions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some slow features will likely get efficient implementations in the
future. You should check this section every once in a while to see
if some additional operations are fast.</p>
</div>
</section>
<section id="using-fast-native-features">
<h2>Using fast native features<a class="headerlink" href="#using-fast-native-features" title="Permalink to this headline">#</a></h2>
<p>Some native operations are particularly quick relative to the
corresponding interpreted operations. Using them as much as possible
may allow you to see 10x or more in performance gains.</p>
<p>Some things are not much (or any) faster in compiled code, such as set
math operations. In contrast, calling a method of a native class is
much faster in compiled code.</p>
<p>If you are used to optimizing for CPython, you might have replaced
some class instances with dictionaries, as they can be
faster. However, in compiled code, this “optimization” would likely
slow down your code.</p>
<p>Similarly, caching a frequently called method in a local variable can
help in CPython, but it can slow things down in compiled code, since
the code won’t use <a class="reference internal" href="differences_from_python.html#early-binding"><span class="std std-ref">early binding</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">squares</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">append</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">append</span>  <span class="c1"># Not a good idea in compiled code!</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>
</pre></div>
</div>
<p>Here are examples of features that are fast, in no particular order
(this list is <em>not</em> exhaustive):</p>
<ul class="simple">
<li><p>Calling compiled functions directly defined in the same compilation
unit (with positional and/or keyword arguments)</p></li>
<li><p>Calling methods of native classes defined in the same compilation
unit (with positional and/or keyword arguments)</p></li>
<li><p>Many integer operations</p></li>
<li><p>Many <code class="docutils literal notranslate"><span class="pre">float</span></code> operations</p></li>
<li><p>Booleans</p></li>
<li><p><a class="reference internal" href="list_operations.html#list-ops"><span class="std std-ref">Native list operations</span></a>, such as indexing,
<code class="docutils literal notranslate"><span class="pre">append</span></code>, and list comprehensions</p></li>
<li><p>While loops</p></li>
<li><p>For loops over ranges and lists, and with <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> or <code class="docutils literal notranslate"><span class="pre">zip</span></code></p></li>
<li><p>Reading dictionary items</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isinstance()</span></code> checks against native classes and instances of
primitive types (and unions of them)</p></li>
<li><p>Accessing local variables</p></li>
<li><p>Accessing attributes of native classes</p></li>
<li><p>Accessing final module-level attributes</p></li>
<li><p>Comparing strings for equality</p></li>
</ul>
<p>These features are also fast, but somewhat less so (relative to other
related operations):</p>
<ul class="simple">
<li><p>Constructing instances of native classes</p></li>
<li><p>Constructing dictionaries</p></li>
<li><p>Setting dictionary items</p></li>
<li><p>Native <a class="reference internal" href="dict_operations.html#dict-ops"><span class="std std-ref">dict</span></a> and <a class="reference internal" href="set_operations.html#set-ops"><span class="std std-ref">set</span></a> operations</p></li>
<li><p>Accessing module-level variables</p></li>
</ul>
<p>Generally anything documented as a native operation is fast, even if
it’s not explicitly mentioned here</p>
</section>
<section id="adjusting-garbage-collection">
<h2>Adjusting garbage collection<a class="headerlink" href="#adjusting-garbage-collection" title="Permalink to this headline">#</a></h2>
<p>Compilation does not speed up cyclic garbage collection. If everything
else gets much faster, it’s possible that garbage collection will take
a big fraction of time. You can use <code class="docutils literal notranslate"><span class="pre">gc.set_threshold()</span></code> to adjust
the garbage collector to run less often:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gc</span>

<span class="c1"># Spend less time in gc; do this before significant computation</span>
<span class="n">gc</span><span class="o">.</span><span class="n">set_threshold</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span>

<span class="o">...</span>  <span class="c1"># Actual work happens here</span>
</pre></div>
</div>
</section>
<section id="fast-interpreter-shutdown">
<h2>Fast interpreter shutdown<a class="headerlink" href="#fast-interpreter-shutdown" title="Permalink to this headline">#</a></h2>
<p>If you allocate many objects, it’s possible that your program spends a
lot of time cleaning up when the Python runtime shuts down. Mypyc
won’t speed up the shutdown of a Python process much.</p>
<p>You can call <code class="docutils literal notranslate"><span class="pre">os._exit(code)</span></code> to immediately terminate the Python
process, skipping normal cleanup. This can give a nice boost to a
batch process or a command-line tool.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This can be dangerous and can lose data. You need to ensure
that all streams are flushed and everything is otherwise cleaned up
properly.</p>
</div>
</section>
<section id="work-smarter">
<h2>Work smarter<a class="headerlink" href="#work-smarter" title="Permalink to this headline">#</a></h2>
<p>Usually there are many things you can do to improve performance, even
if most tweaks will yield only minor gains. The key to being effective
is to focus on things that give a large gain with a small effort.</p>
<p>For example, low-level optimizations, such as avoiding a nested
function, can be pointless, if you could instead avoid a metaclass –
to allow a key class to be compiled as a native class. The latter
optimization could speed up numerous method calls and attribute
accesses, just like that.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./env/lib/python3.9/site-packages/mypyc/doc"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Jupyter Book Community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>